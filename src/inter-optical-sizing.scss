@use "sass:map";

// Inter Optical Sizing
// Opinionated `opsz` and `letter-spacing` settings for the Inter variable font.

// Configuration Map
// Structure: (<font-size>: (<font-weight>: (opsz: <value>, ls: <value>)))
// - font-size: in pixels
// - font-weight: standard font weight values (100-900)
// - opsz: optical size value
// - ls: letter-spacing value in px units
$inter-optical-map: (
  12: (400: (opsz: 12.0, ls: 0.01px),
    450: (opsz: 12.1, ls: 0.005px),
    500: (opsz: 12.1, ls: 0.005px),
    600: (opsz: 12.2, ls: 0px),
    700: (opsz: 12.3, ls: -0.005px)),
  13: (400: (opsz: 12.0, ls: 0.01px),
    450: (opsz: 12.1, ls: 0.005px),
    500: (opsz: 12.1, ls: 0.005px),
    600: (opsz: 12.2, ls: 0px),
    700: (opsz: 12.3, ls: -0.005px)),
  14: (400: (opsz: 13.8, ls: 0.005px),
    450: (opsz: 12.1, ls: 0.005px),
    500: (opsz: 13.9, ls: 0px),
    600: (opsz: 14.0, ls: 0px),
    700: (opsz: 14.1, ls: -0.01px)),
  15: (400: (opsz: 13.8, ls: 0.005px),
    450: (opsz: 12.1, ls: 0.005px),
    500: (opsz: 13.9, ls: 0px),
    600: (opsz: 14.0, ls: 0px),
    700: (opsz: 14.1, ls: -0.01px)),
  16: (400: (opsz: 15.8, ls: 0px),
    450: (opsz: 15.9, ls: 0px),
    500: (opsz: 15.9, ls: 0px),
    600: (opsz: 16.0, ls: -0.005px),
    700: (opsz: 16.1, ls: -0.01px)),
  17: (400: (opsz: 15.8, ls: 0px),
    450: (opsz: 15.9, ls: 0px),
    500: (opsz: 15.9, ls: 0px),
    600: (opsz: 16.0, ls: -0.005px),
    700: (opsz: 16.1, ls: -0.01px)),
  18: (400: (opsz: 14, ls: 0),
    450: (opsz: 14, ls: 0),
    500: (opsz: 14, ls: 0),
    600: (opsz: 14, ls: 0),
    700: (opsz: 14, ls: 0)),
  19: (400: (opsz: 15.8, ls: 0px),
    450: (opsz: 15.9, ls: 0px),
    500: (opsz: 15.9, ls: 0px),
    600: (opsz: 16.0, ls: -0.005px),
    700: (opsz: 16.1, ls: -0.01px)),
  20: (400: (opsz: 14, ls: 0),
    450: (opsz: 14, ls: 0),
    500: (opsz: 14, ls: 0),
    600: (opsz: 14, ls: 0),
    700: (opsz: 14, ls: 0)),
  21: (400: (opsz: 31.7, ls: 0),
    450: (opsz: 31.3, ls: 0),
    500: (opsz: 30.8, ls: 0),
    600: (opsz: 29.2, ls: 0),
    700: (opsz: 27.5, ls: 0)),
  22: (400: (opsz: 32, ls: -0.07px),
    450: (opsz: 32, ls: -0.04px),
    500: (opsz: 32, ls: -0.01px),
    600: (opsz: 30.9, ls: 0),
    700: (opsz: 29, ls: 0)),
  23: (400: (opsz: 32, ls: -0.11px),
    450: (opsz: 32, ls: -0.08px),
    500: (opsz: 32, ls: -0.04px),
    600: (opsz: 31.5, ls: 0),
    700: (opsz: 29.5, ls: 0)),
  24: (400: (opsz: 32, ls: -0.15px),
    450: (opsz: 32, ls: -0.11px),
    500: (opsz: 32, ls: -0.07px),
    600: (opsz: 31.8, ls: 0),
    700: (opsz: 29.9, ls: 0)),
  28: (400: (opsz: 32, ls: -0.15px),
    450: (opsz: 32, ls: -0.12px),
    500: (opsz: 32, ls: -0.05px),
    600: (opsz: 31.7, ls: 0),
    700: (opsz: 29.4, ls: 0)),
  32: (400: (opsz: 32, ls: -0.26px),
    450: (opsz: 32, ls: -0.2px),
    500: (opsz: 32, ls: -0.14px),
    600: (opsz: 32, ls: -0.01px),
    700: (opsz: 30.6, ls: 0)),
  40: (400: (opsz: 32, ls: -0.45px),
    450: (opsz: 32, ls: -0.4px),
    500: (opsz: 32, ls: -0.3px),
    600: (opsz: 32, ls: -0.17px),
    700: (opsz: 32, ls: -0.03px)),
  48: (400: (opsz: 32, ls: -0.63px),
    450: (opsz: 32, ls: -0.56px),
    500: (opsz: 32, ls: -0.48px),
    600: (opsz: 32, ls: -0.3px),
    700: (opsz: 32, ls: -0.12px)),
  56: (400: (opsz: 32, ls: -0.87px),
    450: (opsz: 32, ls: -0.77px),
    500: (opsz: 32, ls: -0.66px),
    600: (opsz: 32, ls: -0.43px),
    700: (opsz: 32, ls: -0.19px)),
  64: (400: (opsz: 32, ls: -1.01px),
    450: (opsz: 32, ls: -0.91px),
    500: (opsz: 32, ls: -0.79px),
    600: (opsz: 32, ls: -0.54px),
    700: (opsz: 32, ls: -0.3px)),
  72: (400: (opsz: 32, ls: -1.26px),
    450: (opsz: 32, ls: -1.13px),
    500: (opsz: 32, ls: -0.99px),
    600: (opsz: 32, ls: -0.73px),
    700: (opsz: 32, ls: -0.45px)),
  80: (400: (opsz: 32, ls: -1.56px),
    450: (opsz: 32, ls: -1.41px),
    500: (opsz: 32, ls: -1.28px),
    600: (opsz: 32, ls: -0.97px),
    700: (opsz: 32, ls: -0.72px))) !default;

// Mixin for generating CSS custom properties
@mixin generate-custom-properties {
  @each $size, $weights in $inter-optical-map {
    @each $weight, $values in $weights {
      --inter-opsz-#{$size}-#{$weight}: #{map.get($values, opsz)};
      --inter-ls-#{$size}-#{$weight}: #{map.get($values, ls)};
    }
  }
}

// Mixin for applying optical sizing properties
@mixin inter-optical($size, $weight) {
  $values: map.get(map.get($inter-optical-map, $size), $weight
  );

@if $values {
  font-size: #{$size}px;
  font-weight: $weight;
  font-variation-settings: "opsz"#{map.get($values, opsz)};

  // Only apply letter-spacing if it's not 0 or 0px
  $ls: map.get($values, ls);

  @if $ls !=0 and $ls !=0px {
    letter-spacing: $ls;
  }
}

@else {
  @warn "No values found for size: #{$size}px, weight: #{$weight}";
}
}

// Generate root custom properties
:root {
  @include generate-custom-properties;
}

// Generate utility classes
@each $size, $weights in $inter-optical-map {
  @each $weight, $values in $weights {
    .inter-opt-#{$size}-#{$weight} {
      @include inter-optical($size, $weight);
    }
  }
}